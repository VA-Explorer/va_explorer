{% extends "base.html" %}

{% block title %}Verbal Autopsy {{ id }}{% endblock %}

{% block content %}

{% if errors %}
<table class="table">
  <thead>
    <tr>
      <th>{{ errors|length }} Error{{ errors|pluralize }}</th>
    </tr>
  </thead>
  <tbody>
    {% for error in errors %}
    <tr><td>{{ error }}</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

{% if warnings %}
<table class="table">
  <thead>
    <tr>
      <th>{{ warnings|length }} Warning{{ warnings|pluralize }}</th>
    </tr>
  </thead>
  <tbody>
    {% for warning in warnings %}
    <tr><td>{{ warning }}</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

{% if diffs %}
<table class="table">
  <thead>
    <tr>
      <th colspan=2>{{ diffs|length }} Change{{ diffs|pluralize }}</th>
    </tr>
  </thead>
  <tbody>
    {% for diff in diffs %}
    <tr>
      <td>{{ diff.new_record.history_date }}</td>
      <td>
        {% for change in diff.changes %}
        {% if change.old and change.new %}
        <b>{{ change.field }}</b> changed from <b>{{ change.old }}</b> to <b>{{ change.new }}</b><br/>
        {% elif change.new %}
        <b>{{ change.field }}</b> was set to <b>{{ change.new }}</b><br/>
        {% elif change.old %}
        <b>{{ change.field }}</b> had value <b>{{ change.old }}</b> deleted<br/>
        {% endif %}
        {% endfor %}
      </td>
    </tr>
    {% endfor %}
</table>
<p><a class="btn btn-primary" href="{% url 'data_management:reset' id=id %}">Reset to Original</a></p>
{% endif %}

<p><a class="btn btn-primary" href="{% url 'data_management:edit' id=id %}">Edit</a></p>

<table class="table">
  <thead>
    <tr>
      <th>Field</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    {% for key, value in va.items %}
    <tr>
      <td>{{ key }}</td>
      <td>{{ value }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
